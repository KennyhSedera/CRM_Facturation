import{U as p,r as d,j as r,H as w}from"./app-CvKhwmMn.js";/* empty css            */function B({telegram_id:y}){const[o,j]=p.useState({article_name:"",selling_price:0,article_unit√©:"",article_tva:0,quantity_stock:0,article_reference:""}),[t,m]=p.useState({}),[i,u]=d.useState(!1),[l,v]=d.useState(null),[N,_]=d.useState(!1),g=d.useRef(o);d.useEffect(()=>{g.current=o},[o]),d.useEffect(()=>{const e=window.Telegram?.WebApp;if(e){v(e),e.ready(),e.expand(),e.enableClosingConfirmation(),document.body.style.backgroundColor=e.themeParams?.bg_color||"#ffffff",document.body.style.color=e.themeParams?.text_color||"#000000",e.MainButton.setText("‚úÖ Cr√©er un article"),e.MainButton.color=e.themeParams?.button_color||"#3390ec",e.MainButton.textColor=e.themeParams?.button_text_color||"#ffffff",e.MainButton.show();const s=()=>{C(e)};return e.MainButton.onClick(s),setTimeout(()=>{_(!0)},1e3),()=>{e.MainButton.offClick(s),e.MainButton.hide()}}else _(!0)},[]);const c=e=>{const{name:s,value:x}=e.target;j(n=>({...n,[s]:x})),t[s]&&m(n=>({...n,[s]:void 0}))},k=e=>{const s={};return e.article_name.trim()||(s.article_name="Le nom de l'article est requis."),(!e.selling_price||isNaN(e.selling_price)||e.selling_price<=0)&&(s.selling_price="Le prix unitaire de l'article est obligatoire."),(!e.article_unit√©||!e.article_unit√©.trim())&&(s.article_unit√©="L'unit√© de l'article est obligatoire."),(e.article_tva===void 0||isNaN(e.article_tva)||e.article_tva<0)&&(s.article_tva="La TVA de l'article doit √™tre un nombre positif."),(e.quantity_stock===void 0||isNaN(e.quantity_stock)||e.quantity_stock<0)&&(s.quantity_stock="La quantit√© en stock doit √™tre un nombre positif."),s},C=e=>{const s=g.current,x=k(s);if(Object.keys(x).length>0){m(x),e?e.showAlert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire"):alert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire");return}u(!0),e?.MainButton.showProgress();try{const n=JSON.stringify(s);if(e){const P=`/api/telegram/article/create/${e.initDataUnsafe?.user?.id||y}`;fetch(P,{method:"POST",headers:{"Content-Type":"application/json"},body:n}).then(a=>a.json()).then(a=>{a.success?(e.showAlert("‚úÖ Article cr√©√©e avec succ√®s!"),setTimeout(()=>{e.close()},1e3)):(a.errors&&typeof a.errors=="object"?Object.keys(a.errors).forEach(f=>{const b=a.errors[f];Array.isArray(b)?m(h=>({...h,[f]:b.join(", ")})):m(h=>({...h,[f]:b}))}):a.message?e.showAlert("Erreur : "+a.message):e.showAlert("Erreur inconnue"),u(!1),e.MainButton.hideProgress())}).catch(a=>{e.showAlert("‚ùå Une erreur est survenue: "+a),e.MainButton.hideProgress(),u(!1),e.close()})}else alert(`‚úÖ Article cr√©√©e! (Mode test)

Donn√©es: `+n),u(!1)}catch(n){e?(e.showAlert("‚ùå Une erreur est survenue: "+n),e.MainButton.hideProgress()):alert("‚ùå Une erreur est survenue: "+n),u(!1)}};return r.jsxs(r.Fragment,{children:[r.jsx(w,{title:"Cr√©er un article"}),r.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:l?.themeParams?.bg_color||"#ffffff",color:l?.themeParams?.text_color||"#000000"},children:r.jsxs("div",{className:"mx-auto max-w-2xl",children:[r.jsxs("div",{className:"mb-6 text-center",children:[r.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"üè¢ Cr√©er un article"}),r.jsx("p",{className:"opacity-70",children:"Remplissez les informations de votre article"})]}),r.jsxs("div",{className:"space-y-5",children:[r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"article_name",className:"mb-2 block text-sm font-semibold",children:["Nom de l'article ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"article_name",name:"article_name",value:o.article_name,onChange:c,placeholder:"Ex: Panneau solaire 100W",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_name?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),t.article_name&&r.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[r.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_name]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"article_reference",className:"mb-2 block text-sm font-semibold",children:"R√©f√©rence de l'article"}),r.jsx("input",{type:"text",id:"article_reference",name:"article_reference",value:o.article_reference,onChange:c,placeholder:"Ex: ART-001",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_reference?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),t.article_reference&&r.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[r.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_reference]})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"selling_price",className:"mb-2 block text-sm font-semibold",children:["Prix unitaire de l'article ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("input",{type:"text",id:"selling_price",name:"selling_price",value:o.selling_price,onChange:c,placeholder:"Ex: 12000",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.selling_price?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),r.jsx("span",{children:"FCFA"})]}),t.selling_price&&r.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[r.jsx("span",{children:"‚ö†Ô∏è"})," ",t.selling_price]})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"article_unit√©",className:"mb-2 block text-sm font-semibold",children:["Unit√© de l'article ",r.jsx("span",{className:"text-red-500",children:"*"})]}),r.jsx("input",{type:"text",id:"article_unit√©",name:"article_unit√©",value:o.article_unit√©,onChange:c,placeholder:"Ex: Pi√®ce",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_unit√©?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),t.article_unit√©&&r.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[r.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_unit√©]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"article_tva",className:"mb-2 block text-sm font-semibold",children:"TVA de l'article"}),r.jsx("input",{type:"number",id:"article_tva",name:"article_tva",value:o.article_tva,onChange:c,placeholder:"Ex: 10",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_tva?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),t.article_tva&&r.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[r.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_tva]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"quantity_stock",className:"mb-2 block text-sm font-semibold",children:"Quantit√© en stock"}),r.jsx("input",{type:"number",id:"quantity_stock",name:"quantity_stock",value:o.quantity_stock,onChange:c,placeholder:"Ex: 100",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.quantity_stock?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),t.quantity_stock&&r.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[r.jsx("span",{children:"‚ö†Ô∏è"})," ",t.quantity_stock]})]})]}),r.jsx("div",{className:"mt-8 rounded-xl border-2 border-blue-200 bg-blue-50 p-4",children:r.jsxs("p",{className:"flex items-start gap-2 text-sm text-blue-800",children:[r.jsx("span",{className:"text-lg",children:"‚ÑπÔ∏è"}),r.jsx("span",{children:N?"Cliquez sur le bouton ci-dessus pour cr√©er votre article":"Cliquez sur le bouton en bas de l'√©cran pour cr√©er votre article"})]})})]})})]})}export{B as default};
