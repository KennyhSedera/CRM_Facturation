import{U as g,r as d,j as e,H as w}from"./app-CTrdLXK-.js";/* empty css            */function B({telegram_id:y}){const[o,j]=g.useState({article_name:"",selling_price:0,article_unit√©:"",article_tva:0,quantity_stock:0,article_reference:""}),[t,u]=g.useState({}),[i,m]=d.useState(!1),[s,v]=d.useState(null),[N,_]=d.useState(!1),p=d.useRef(o);d.useEffect(()=>{p.current=o},[o]),d.useEffect(()=>{const r=window.Telegram?.WebApp;if(r){v(r),r.ready(),r.expand(),r.enableClosingConfirmation(),document.body.style.backgroundColor=r.themeParams?.bg_color||"#ffffff",document.body.style.color=r.themeParams?.text_color||"#000000",r.MainButton.setText("‚úÖ Cr√©er un article"),r.MainButton.color=r.themeParams?.button_color||"#3390ec",r.MainButton.textColor=r.themeParams?.button_text_color||"#ffffff",r.MainButton.show();const l=()=>{C(r)};return r.MainButton.onClick(l),setTimeout(()=>{_(!0)},1e3),()=>{r.MainButton.offClick(l),r.MainButton.hide()}}else _(!0)},[]);const c=r=>{const{name:l,value:x}=r.target;j(n=>({...n,[l]:x})),t[l]&&u(n=>({...n,[l]:void 0}))},k=r=>{const l={};return r.article_name.trim()||(l.article_name="Le nom de l'article est requis."),(!r.selling_price||isNaN(r.selling_price)||r.selling_price<=0)&&(l.selling_price="Le prix unitaire de l'article est obligatoire."),(!r.article_unit√©||!r.article_unit√©.trim())&&(l.article_unit√©="L'unit√© de l'article est obligatoire."),(r.article_tva===void 0||isNaN(r.article_tva)||r.article_tva<0)&&(l.article_tva="La TVA de l'article doit √™tre un nombre positif."),(r.quantity_stock===void 0||isNaN(r.quantity_stock)||r.quantity_stock<0)&&(l.quantity_stock="La quantit√© en stock doit √™tre un nombre positif."),l},C=r=>{const l=p.current,x=k(l);if(Object.keys(x).length>0){u(x);return}m(!0),r?.MainButton.showProgress();try{const n=JSON.stringify(l);if(r){const P=`/api/telegram/article/create/${r.initDataUnsafe?.user?.id||y}`;fetch(P,{method:"POST",headers:{"Content-Type":"application/json"},body:n}).then(a=>a.json()).then(a=>{a.success?(r.showAlert("‚úÖ Article cr√©√©e avec succ√®s!"),setTimeout(()=>{r.close()},1e3)):(a.errors&&typeof a.errors=="object"?Object.keys(a.errors).forEach(b=>{const f=a.errors[b];Array.isArray(f)?u(h=>({...h,[b]:f.join(", ")})):u(h=>({...h,[b]:f}))}):a.message?r.showAlert("Erreur : "+a.message):r.showAlert("Erreur inconnue"),m(!1),r.MainButton.hideProgress())}).catch(a=>{r.showAlert("‚ùå Une erreur est survenue: "+a),r.MainButton.hideProgress(),m(!1),r.close()})}else alert(`‚úÖ Article cr√©√©e! (Mode test)

Donn√©es: `+n),m(!1)}catch(n){r?(r.showAlert("‚ùå Une erreur est survenue: "+n),r.MainButton.hideProgress()):alert("‚ùå Une erreur est survenue: "+n),m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Cr√©er un article"}),e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:s?.themeParams?.bg_color||"#ffffff",color:s?.themeParams?.text_color||"#000000"},children:e.jsxs("div",{className:"mx-auto max-w-2xl",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"üè¢ Cr√©er un article"}),e.jsx("p",{className:"opacity-70",children:"Remplissez les informations de votre article"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"article_name",className:"mb-2 block text-sm font-semibold",children:["Nom de l'article ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"article_name",name:"article_name",value:o.article_name,onChange:c,placeholder:"Ex: Panneau solaire 100W",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_name?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:s?.themeParams?.secondary_bg_color||"#f5f5f5",color:s?.themeParams?.text_color||"#000000"},disabled:i}),t.article_name&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_name]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"article_reference",className:"mb-2 block text-sm font-semibold",children:"R√©f√©rence de l'article"}),e.jsx("input",{type:"text",id:"article_reference",name:"article_reference",value:o.article_reference,onChange:c,placeholder:"Ex: ART-001",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_reference?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:s?.themeParams?.secondary_bg_color||"#f5f5f5",color:s?.themeParams?.text_color||"#000000"},disabled:i}),t.article_reference&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_reference]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"selling_price",className:"mb-2 block text-sm font-semibold",children:["Prix unitaire de l'article ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("input",{type:"text",id:"selling_price",name:"selling_price",value:o.selling_price,onChange:c,placeholder:"Ex: 12000",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.selling_price?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:s?.themeParams?.secondary_bg_color||"#f5f5f5",color:s?.themeParams?.text_color||"#000000"},disabled:i}),e.jsx("span",{className:"rounded-xl border-2 px-4 py-3",style:{backgroundColor:s?.themeParams?.secondary_bg_color||"#f5f5f5",color:s?.themeParams?.text_color||"#000000"},children:"FCFA"})]}),t.selling_price&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",t.selling_price]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"article_unit√©",className:"mb-2 block text-sm font-semibold",children:["Unit√© de l'article ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"article_unit√©",name:"article_unit√©",value:o.article_unit√©,onChange:c,placeholder:"Ex: Pi√®ce",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_unit√©?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:s?.themeParams?.secondary_bg_color||"#f5f5f5",color:s?.themeParams?.text_color||"#000000"},disabled:i}),t.article_unit√©&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_unit√©]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"article_tva",className:"mb-2 block text-sm font-semibold",children:"TVA de l'article"}),e.jsx("input",{type:"number",id:"article_tva",name:"article_tva",value:o.article_tva,onChange:c,placeholder:"Ex: 10",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.article_tva?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:s?.themeParams?.secondary_bg_color||"#f5f5f5",color:s?.themeParams?.text_color||"#000000"},disabled:i}),t.article_tva&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",t.article_tva]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"quantity_stock",className:"mb-2 block text-sm font-semibold",children:"Quantit√© en stock"}),e.jsx("input",{type:"number",id:"quantity_stock",name:"quantity_stock",value:o.quantity_stock,onChange:c,placeholder:"Ex: 100",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${t.quantity_stock?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:s?.themeParams?.secondary_bg_color||"#f5f5f5",color:s?.themeParams?.text_color||"#000000"},disabled:i}),t.quantity_stock&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",t.quantity_stock]})]})]}),e.jsx("div",{className:"mt-8 rounded-xl border-2 border-blue-200 bg-blue-50 p-4",children:e.jsxs("p",{className:"flex items-start gap-2 text-sm text-blue-800",children:[e.jsx("span",{className:"text-lg",children:"‚ÑπÔ∏è"}),e.jsx("span",{children:N?"Cliquez sur le bouton ci-dessus pour cr√©er votre article":"Cliquez sur le bouton en bas de l'√©cran pour cr√©er votre article"})]})})]})})]})}export{B as default};
