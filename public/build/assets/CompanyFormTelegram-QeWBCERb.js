import{r as c,j as e,H as w}from"./app-dN6jxuqz.js";/* empty css            */function E({telegram_id:f}){const[t,_]=c.useState({company_name:"",company_email:"",company_description:"",company_phone:"",company_website:"",company_address:""}),[n,u]=c.useState({}),[l,p]=c.useState(!1),[r,g]=c.useState(null),[x,b]=c.useState(!1),h=c.useRef(t);c.useEffect(()=>{h.current=t},[t]),c.useEffect(()=>{const o=window.Telegram?.WebApp;if(console.log("Telegram WebApp disponible:",!!o),o){g(o),o.ready(),o.expand(),o.enableClosingConfirmation(),document.body.style.backgroundColor=o.themeParams?.bg_color||"#ffffff",document.body.style.color=o.themeParams?.text_color||"#000000",o.MainButton.setText("‚úÖ Cr√©er l'entreprise"),o.MainButton.color=o.themeParams?.button_color||"#3390ec",o.MainButton.textColor=o.themeParams?.button_text_color||"#ffffff",o.MainButton.show();const s=()=>{y(o)};return o.MainButton.onClick(s),setTimeout(()=>{b(!0)},1e3),()=>{o.MainButton.offClick(s),o.MainButton.hide()}}else console.warn("Telegram WebApp non disponible"),b(!0)},[]);const m=o=>{const{name:s,value:i}=o.target;_(a=>({...a,[s]:i})),n[s]&&u(a=>({...a,[s]:void 0}))},j=o=>{const s={};o.company_name.trim()?o.company_name.trim().length<2&&(s.company_name="Le nom doit contenir au moins 2 caract√®res"):s.company_name="Le nom de l'entreprise est requis";const i=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return o.company_email.trim()?i.test(o.company_email)||(s.company_email="L'email doit √™tre valide"):s.company_email="L'email est requis",o.company_description.trim()?o.company_description.trim().length<10&&(s.company_description="La description doit contenir au moins 10 caract√®res"):s.company_description="La description est requise",o.company_phone.trim()?o.company_phone.trim().length<8&&(s.company_phone="Le t√©l√©phone doit contenir au moins 8 caract√®res"):s.company_phone="Le t√©l√©phone est requis",o.company_address.trim()?o.company_address.trim().length<5&&(s.company_address="L'adresse doit contenir au moins 5 caract√®res"):s.company_address="L'adresse est requise",s},y=o=>{const s=h.current,i=j(s);if(Object.keys(i).length>0){console.log("Erreurs de validation:",i),u(i),o?o.showAlert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire"):alert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire");return}p(!0),o?.MainButton.showProgress();try{const a=JSON.stringify(s);if(console.log("Donn√©es √† envoyer:",a),o){const N=`/api/telegram/company/create/${o.initDataUnsafe?.user?.id||f}`;fetch(N,{method:"POST",headers:{"Content-Type":"application/json"},body:a}).then(d=>d.json()).then(d=>{console.log("Donn√©es envoy√©es:",d),alert(`‚úÖ Entreprise cr√©√©e!

Donn√©es: `+a),p(!1)}).catch(d=>{console.error("Erreur lors de l'envoi:",d),o.showAlert("‚ùå Une erreur est survenue: "+d),o.MainButton.hideProgress(),p(!1)}),setTimeout(()=>{console.log("Fermeture de la WebApp"),o.close()},2e3)}else console.log("Mode fallback - Donn√©es:",a),alert(`‚úÖ Entreprise cr√©√©e! (Mode test)

Donn√©es: `+a),p(!1)}catch(a){console.error("Erreur lors de l'envoi:",a),o?(o.showAlert("‚ùå Une erreur est survenue: "+a),o.MainButton.hideProgress()):alert("‚ùå Une erreur est survenue: "+a),p(!1)}},v=()=>{y(r)};return e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Cr√©er mon entreprise"}),e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:r?.themeParams?.bg_color||"#ffffff",color:r?.themeParams?.text_color||"#000000"},children:e.jsxs("div",{className:"mx-auto max-w-2xl",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"üè¢ Cr√©er mon entreprise"}),e.jsx("p",{className:"opacity-70",children:"Remplissez les informations de votre entreprise"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"company_name",className:"mb-2 block text-sm font-semibold",children:["Nom de l'entreprise ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"company_name",name:"company_name",value:t.company_name,onChange:m,placeholder:"Ex: TechSolutions Madagascar",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${n.company_name?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:l}),n.company_name&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.company_name]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"company_email",className:"mb-2 block text-sm font-semibold",children:["Email professionnel ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",id:"company_email",name:"company_email",value:t.company_email,onChange:m,placeholder:"contact@techsolutions.mg",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${n.company_email?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:l}),n.company_email&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.company_email]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"company_description",className:"mb-2 block text-sm font-semibold",children:["Description de l'activit√© ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"company_description",name:"company_description",value:t.company_description,onChange:m,placeholder:"D√©crivez votre activit√© principale...",rows:4,maxLength:500,className:`w-full resize-y rounded-xl border-2 px-4 py-3 transition-all ${n.company_description?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:l}),n.company_description&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.company_description]}),e.jsxs("p",{className:"mt-1 text-xs opacity-60",children:[t.company_description.length," / 500 caract√®res"]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"company_phone",className:"mb-2 block text-sm font-semibold",children:["T√©l√©phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",id:"company_phone",name:"company_phone",value:t.company_phone,onChange:m,placeholder:"Ex: +261 34 12 345 67",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${n.company_phone?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:l}),n.company_phone&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.company_phone]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"company_website",className:"mb-2 block text-sm font-semibold",children:["Site web ",e.jsx("span",{className:"text-gray-400",children:"(optionnel)"})]}),e.jsx("input",{type:"url",id:"company_website",name:"company_website",value:t.company_website,onChange:m,placeholder:"Ex: www.techsolutions.mg",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:l})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"company_address",className:"mb-2 block text-sm font-semibold",children:["Adresse compl√®te ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"company_address",name:"company_address",value:t.company_address,onChange:m,placeholder:"Ex: Lot II A 45, Antananarivo 101",rows:3,className:`w-full resize-y rounded-xl border-2 px-4 py-3 transition-all ${n.company_address?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:l}),n.company_address&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.company_address]})]})]}),x&&e.jsx("button",{onClick:v,disabled:l,className:"mt-6 w-full rounded-xl bg-blue-500 px-6 py-4 font-semibold text-white transition-all hover:bg-blue-600 disabled:opacity-50",style:{backgroundColor:r?.themeParams?.button_color||"#3390ec",color:r?.themeParams?.button_text_color||"#ffffff"},children:l?"‚è≥ Envoi en cours...":"‚úÖ Cr√©er l'entreprise"}),e.jsx("div",{className:"mt-8 rounded-xl border-2 border-blue-200 bg-blue-50 p-4",children:e.jsxs("p",{className:"flex items-start gap-2 text-sm text-blue-800",children:[e.jsx("span",{className:"text-lg",children:"‚ÑπÔ∏è"}),e.jsx("span",{children:x?"Cliquez sur le bouton ci-dessus pour cr√©er votre entreprise":"Cliquez sur le bouton en bas de l'√©cran pour cr√©er votre entreprise"})]})}),!r&&e.jsx("div",{className:"mt-4 rounded-xl border-2 border-yellow-200 bg-yellow-50 p-4",children:e.jsx("p",{className:"text-sm text-yellow-800",children:"‚ö†Ô∏è Mode d√©veloppement: Telegram WebApp non d√©tect√©"})})]})})]})}export{E as default};
