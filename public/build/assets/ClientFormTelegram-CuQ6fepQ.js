import{U as j,r as c,j as t,H as k}from"./app-CZZSJwVs.js";/* empty css            */function S({telegram_id:g}){const[a,y]=j.useState({client_name:"",client_email:"",client_phone:"",client_adress:""}),[r,d]=j.useState({}),[m,i]=c.useState(!1),[l,v]=c.useState(null),[N,_]=c.useState(!1),p=c.useRef(a);c.useEffect(()=>{p.current=a},[a]),c.useEffect(()=>{const e=window.Telegram?.WebApp;if(e){v(e),e.ready(),e.expand(),e.enableClosingConfirmation(),document.body.style.backgroundColor=e.themeParams?.bg_color||"#ffffff",document.body.style.color=e.themeParams?.text_color||"#000000",e.MainButton.setText("‚úÖ Cr√©er le client"),e.MainButton.color=e.themeParams?.button_color||"#3390ec",e.MainButton.textColor=e.themeParams?.button_text_color||"#ffffff",e.MainButton.show();const s=()=>{P(e)};return e.MainButton.onClick(s),setTimeout(()=>{_(!0)},1e3),()=>{e.MainButton.offClick(s),e.MainButton.hide()}}else _(!0)},[]);const u=e=>{const{name:s,value:h}=e.target;y(o=>({...o,[s]:h})),r[s]&&d(o=>({...o,[s]:void 0}))},C=e=>{const s={};return e.client_name.trim()||(s.client_name="Le nom du client est requis."),e.client_email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.client_email)||(s.client_email="L'email du client n'est pas valide."):s.client_email="L'email du client est requis.",e.client_phone?.trim()||(s.client_phone="Le t√©l√©phone du client est requis."),s},P=e=>{const s=p.current,h=C(s);if(Object.keys(h).length>0){d(h);return}i(!0),e?.MainButton.showProgress();try{const o=JSON.stringify(s);if(e){const w=`/api/telegram/client/create/${e.initDataUnsafe?.user?.id||g}`;fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:o}).then(n=>n.json()).then(n=>{n.success?(e.showAlert("‚úÖ client cr√©√©e avec succ√®s!"),setTimeout(()=>{e.close()},1e3)):(n.errors&&typeof n.errors=="object"?Object.keys(n.errors).forEach(x=>{const f=n.errors[x];Array.isArray(f)?d(b=>({...b,[x]:f.join(", ")})):d(b=>({...b,[x]:f}))}):n.message?e.showAlert("Erreur : "+n.message):e.showAlert("Erreur inconnue"),i(!1),e.MainButton.hideProgress())}).catch(n=>{e.showAlert("‚ùå Une erreur est survenue: "+n),e.MainButton.hideProgress(),i(!1),e.close()})}else alert(`‚úÖ client cr√©√©e! (Mode test)

Donn√©es: `+o),i(!1)}catch(o){e?(e.showAlert("‚ùå Une erreur est survenue: "+o),e.MainButton.hideProgress()):alert("‚ùå Une erreur est survenue: "+o),i(!1)}};return t.jsxs(t.Fragment,{children:[t.jsx(k,{title:"Cr√©er un client"}),t.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:l?.themeParams?.bg_color||"#ffffff",color:l?.themeParams?.text_color||"#000000"},children:t.jsxs("div",{className:"mx-auto max-w-2xl",children:[t.jsxs("div",{className:"mb-6 text-center",children:[t.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"üè¢ Cr√©er un client"}),t.jsx("p",{className:"opacity-70",children:"Remplissez les informations de votre client"})]}),t.jsxs("div",{className:"space-y-5",children:[t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"client_name",className:"mb-2 block text-sm font-semibold",children:["Nom du client ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"text",id:"client_name",name:"client_name",value:a.client_name,onChange:u,placeholder:"Ex: TechSolutions Madagascar",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${r.client_name?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:m}),r.client_name&&t.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[t.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_name]})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"client_email",className:"mb-2 block text-sm font-semibold",children:["Email du client ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"email",id:"client_email",name:"client_email",value:a.client_email,onChange:u,placeholder:"Ex: 4Hs9O@example.com",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:m}),r.client_email&&t.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[t.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_email]})]}),t.jsxs("div",{children:[t.jsxs("label",{htmlFor:"client_phone",className:"mb-2 block text-sm font-semibold",children:["T√©l√©phone du client ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsx("input",{type:"tel",id:"client_phone",name:"client_phone",value:a.client_phone,onChange:u,placeholder:"Ex: +261 34 12 345 67",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:m}),r.client_phone&&t.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[t.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_phone]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"client_adress",className:"mb-2 block text-sm font-semibold",children:"Adresse du client"}),t.jsx("input",{type:"text",id:"client_adress",name:"client_adress",value:a.client_adress,onChange:u,placeholder:"Ex: 123 Rue de l'Innovation, Antananarivo",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:m}),r.client_adress&&t.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[t.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_adress]})]})]}),t.jsx("div",{className:"mt-8 rounded-xl border-2 border-blue-200 bg-blue-50 p-4",children:t.jsxs("p",{className:"flex items-start gap-2 text-sm text-blue-800",children:[t.jsx("span",{className:"text-lg",children:"‚ÑπÔ∏è"}),t.jsx("span",{children:N?"Cliquez sur le bouton ci-dessus pour cr√©er votre client":"Cliquez sur le bouton en bas de l'√©cran pour cr√©er votre client"})]})})]})})]})}export{S as default};
