import{U as j,r as c,j as s,H as k}from"./app-GTaubTcA.js";/* empty css            */function S({telegram_id:g}){const[a,y]=j.useState({client_name:"",client_email:"",client_phone:"",client_cin:"",client_adress:""}),[l,u]=j.useState({}),[i,d]=c.useState(!1),[r,N]=c.useState(null),[v,_]=c.useState(!1),p=c.useRef(a);c.useEffect(()=>{p.current=a},[a]),c.useEffect(()=>{const e=window.Telegram?.WebApp;if(e){N(e),e.ready(),e.expand(),e.enableClosingConfirmation(),document.body.style.backgroundColor=e.themeParams?.bg_color||"#ffffff",document.body.style.color=e.themeParams?.text_color||"#000000",e.MainButton.setText("‚úÖ Cr√©er le client"),e.MainButton.color=e.themeParams?.button_color||"#3390ec",e.MainButton.textColor=e.themeParams?.button_text_color||"#ffffff",e.MainButton.show();const t=()=>{P(e)};return e.MainButton.onClick(t),setTimeout(()=>{_(!0)},1e3),()=>{e.MainButton.offClick(t),e.MainButton.hide()}}else _(!0)},[]);const m=e=>{const{name:t,value:x}=e.target;y(o=>({...o,[t]:x})),l[t]&&u(o=>({...o,[t]:void 0}))},C=e=>{const t={};return e.client_name.trim()||(t.client_name="Le nom du client est requis."),e.client_email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.client_email)||(t.client_email="L'email du client n'est pas valide."):t.client_email="L'email du client est requis.",e.client_phone?.trim()||(t.client_phone="Le t√©l√©phone du client est requis."),t},P=e=>{const t=p.current,x=C(t);if(Object.keys(x).length>0){u(x),e?e.showAlert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire"):alert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire");return}d(!0),e?.MainButton.showProgress();try{const o=JSON.stringify(t);if(e){const w=`/api/telegram/client/create/${e.initDataUnsafe?.user?.id||g}`;fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:o}).then(n=>n.json()).then(n=>{n.success?(e.showAlert("‚úÖ client cr√©√©e avec succ√®s!"),setTimeout(()=>{e.close()},1e3)):(n.errors&&typeof n.errors=="object"?Object.keys(n.errors).forEach(h=>{const f=n.errors[h];Array.isArray(f)?u(b=>({...b,[h]:f.join(", ")})):u(b=>({...b,[h]:f}))}):n.message?e.showAlert("Erreur : "+n.message):e.showAlert("Erreur inconnue"),d(!1),e.MainButton.hideProgress())}).catch(n=>{e.showAlert("‚ùå Une erreur est survenue: "+n),e.MainButton.hideProgress(),d(!1),e.close()})}else alert(`‚úÖ client cr√©√©e! (Mode test)

Donn√©es: `+o),d(!1)}catch(o){e?(e.showAlert("‚ùå Une erreur est survenue: "+o),e.MainButton.hideProgress()):alert("‚ùå Une erreur est survenue: "+o),d(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(k,{title:"Cr√©er un client"}),s.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:r?.themeParams?.bg_color||"#ffffff",color:r?.themeParams?.text_color||"#000000"},children:s.jsxs("div",{className:"mx-auto max-w-2xl",children:[s.jsxs("div",{className:"mb-6 text-center",children:[s.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"üè¢ Cr√©er un client"}),s.jsx("p",{className:"opacity-70",children:"Remplissez les informations de votre client"})]}),s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"client_name",className:"mb-2 block text-sm font-semibold",children:["Nom du client ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",id:"client_name",name:"client_name",value:a.client_name,onChange:m,placeholder:"Ex: TechSolutions Madagascar",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${l.client_name?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:i}),l.client_name&&s.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[s.jsx("span",{children:"‚ö†Ô∏è"})," ",l.client_name]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"client_email",className:"mb-2 block text-sm font-semibold",children:["Email du client ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"email",id:"client_email",name:"client_email",value:a.client_email,onChange:m,placeholder:"Ex: 4Hs9O@example.com",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:i}),l.client_email&&s.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[s.jsx("span",{children:"‚ö†Ô∏è"})," ",l.client_email]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"client_phone",className:"mb-2 block text-sm font-semibold",children:["T√©l√©phone du client ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"tel",id:"client_phone",name:"client_phone",value:a.client_phone,onChange:m,placeholder:"Ex: +261 34 12 345 67",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:i}),l.client_phone&&s.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[s.jsx("span",{children:"‚ö†Ô∏è"})," ",l.client_phone]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"client_cin",className:"mb-2 block text-sm font-semibold",children:"CIN du client"}),s.jsx("input",{type:"text",id:"client_cin",name:"client_cin",value:a.client_cin,onChange:m,placeholder:"Ex: 1 23 456 789",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:i}),l.client_cin&&s.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[s.jsx("span",{children:"‚ö†Ô∏è"})," ",l.client_cin]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"client_adress",className:"mb-2 block text-sm font-semibold",children:"Adresse du client"}),s.jsx("input",{type:"text",id:"client_adress",name:"client_adress",value:a.client_adress,onChange:m,placeholder:"Ex: 123 Rue de l'Innovation, Antananarivo",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:r?.themeParams?.secondary_bg_color||"#f5f5f5",color:r?.themeParams?.text_color||"#000000"},disabled:i}),l.client_adress&&s.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[s.jsx("span",{children:"‚ö†Ô∏è"})," ",l.client_adress]})]})]}),s.jsx("div",{className:"mt-8 rounded-xl border-2 border-blue-200 bg-blue-50 p-4",children:s.jsxs("p",{className:"flex items-start gap-2 text-sm text-blue-800",children:[s.jsx("span",{className:"text-lg",children:"‚ÑπÔ∏è"}),s.jsx("span",{children:v?"Cliquez sur le bouton ci-dessus pour cr√©er votre client":"Cliquez sur le bouton en bas de l'√©cran pour cr√©er votre client"})]})})]})})]})}export{S as default};
