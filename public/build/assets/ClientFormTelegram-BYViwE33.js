import{U as j,r as c,j as e,H as w}from"./app-Xl9jlyW6.js";/* empty css            */function S({telegram_id:g}){const[a,y]=j.useState({client_name:"",client_email:"",client_phone:"",client_cin:"",client_adress:""}),[n,u]=j.useState({}),[i,d]=c.useState(!1),[l,N]=c.useState(null),[v,_]=c.useState(!1),p=c.useRef(a);c.useEffect(()=>{p.current=a},[a]),c.useEffect(()=>{const t=window.Telegram?.WebApp;if(t){N(t),t.ready(),t.expand(),t.enableClosingConfirmation(),document.body.style.backgroundColor=t.themeParams?.bg_color||"#ffffff",document.body.style.color=t.themeParams?.text_color||"#000000",t.MainButton.setText("‚úÖ Cr√©er le client"),t.MainButton.color=t.themeParams?.button_color||"#3390ec",t.MainButton.textColor=t.themeParams?.button_text_color||"#ffffff",t.MainButton.show();const s=()=>{P(t)};return t.MainButton.onClick(s),setTimeout(()=>{_(!0)},1e3),()=>{t.MainButton.offClick(s),t.MainButton.hide()}}else _(!0)},[]);const m=t=>{const{name:s,value:x}=t.target;y(o=>({...o,[s]:x})),n[s]&&u(o=>({...o,[s]:void 0}))},C=t=>{const s={};return t.client_name.trim()||(s.client_name="Le nom du client est requis."),t.client_email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.client_email)||(s.client_email="L'email du client n'est pas valide."):s.client_email="L'email du client est requis.",t.client_phone?.trim()||(s.client_phone="Le t√©l√©phone du client est requis."),s},P=t=>{const s=p.current,x=C(s);if(Object.keys(x).length>0){u(x);return}d(!0),t?.MainButton.showProgress();try{const o=JSON.stringify(s);if(t){const k=`/api/telegram/client/create/${t.initDataUnsafe?.user?.id||g}`;fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:o}).then(r=>r.json()).then(r=>{r.success?(t.showAlert("‚úÖ client cr√©√©e avec succ√®s!"),setTimeout(()=>{t.close()},1e3)):(r.errors&&typeof r.errors=="object"?Object.keys(r.errors).forEach(h=>{const f=r.errors[h];Array.isArray(f)?u(b=>({...b,[h]:f.join(", ")})):u(b=>({...b,[h]:f}))}):r.message?t.showAlert("Erreur : "+r.message):t.showAlert("Erreur inconnue"),d(!1),t.MainButton.hideProgress())}).catch(r=>{t.showAlert("‚ùå Une erreur est survenue: "+r),t.MainButton.hideProgress(),d(!1),t.close()})}else alert(`‚úÖ client cr√©√©e! (Mode test)

Donn√©es: `+o),d(!1)}catch(o){t?(t.showAlert("‚ùå Une erreur est survenue: "+o),t.MainButton.hideProgress()):alert("‚ùå Une erreur est survenue: "+o),d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Cr√©er un client"}),e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:l?.themeParams?.bg_color||"#ffffff",color:l?.themeParams?.text_color||"#000000"},children:e.jsxs("div",{className:"mx-auto max-w-2xl",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"üè¢ Cr√©er un client"}),e.jsx("p",{className:"opacity-70",children:"Remplissez les informations de votre client"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"client_name",className:"mb-2 block text-sm font-semibold",children:["Nom du client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"client_name",name:"client_name",value:a.client_name,onChange:m,placeholder:"Ex: TechSolutions Madagascar",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${n.client_name?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),n.client_name&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.client_name]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"client_email",className:"mb-2 block text-sm font-semibold",children:["Email du client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",id:"client_email",name:"client_email",value:a.client_email,onChange:m,placeholder:"Ex: 4Hs9O@example.com",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),n.client_email&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.client_email]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"client_phone",className:"mb-2 block text-sm font-semibold",children:["T√©l√©phone du client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",id:"client_phone",name:"client_phone",value:a.client_phone,onChange:m,placeholder:"Ex: +261 34 12 345 67",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),n.client_phone&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.client_phone]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"client_cin",className:"mb-2 block text-sm font-semibold",children:"CIN du client"}),e.jsx("input",{type:"text",id:"client_cin",name:"client_cin",value:a.client_cin,onChange:m,placeholder:"Ex: 1 23 456 789",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),n.client_cin&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.client_cin]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"client_adress",className:"mb-2 block text-sm font-semibold",children:"Adresse du client"}),e.jsx("input",{type:"text",id:"client_adress",name:"client_adress",value:a.client_adress,onChange:m,placeholder:"Ex: 123 Rue de l'Innovation, Antananarivo",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:l?.themeParams?.secondary_bg_color||"#f5f5f5",color:l?.themeParams?.text_color||"#000000"},disabled:i}),n.client_adress&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",n.client_adress]})]})]}),e.jsx("div",{className:"mt-8 rounded-xl border-2 border-blue-200 bg-blue-50 p-4",children:e.jsxs("p",{className:"flex items-start gap-2 text-sm text-blue-800",children:[e.jsx("span",{className:"text-lg",children:"‚ÑπÔ∏è"}),e.jsx("span",{children:v?"Cliquez sur le bouton ci-dessus pour cr√©er votre client":"Cliquez sur le bouton en bas de l'√©cran pour cr√©er votre client"})]})})]})})]})}export{S as default};
