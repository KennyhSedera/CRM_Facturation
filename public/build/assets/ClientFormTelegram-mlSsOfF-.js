import{U as g,r as i,j as e,H as E}from"./app-DFOvIg84.js";/* empty css            */function F({telegram_id:y}){const[a,N]=g.useState({client_name:"",client_email:"",client_phone:"",client_cin:"",client_address:""}),[r,u]=g.useState({}),[c,d]=i.useState(!1),[n,v]=i.useState(null),[C,p]=i.useState(!1),j=i.useRef(a);i.useEffect(()=>{j.current=a},[a]),i.useEffect(()=>{const s=window.Telegram?.WebApp;if(s){v(s),s.ready(),s.expand(),s.enableClosingConfirmation(),document.body.style.backgroundColor=s.themeParams?.bg_color||"#ffffff",document.body.style.color=s.themeParams?.text_color||"#000000",s.MainButton.setText("‚úÖ Cr√©er l'entreprise"),s.MainButton.color=s.themeParams?.button_color||"#3390ec",s.MainButton.textColor=s.themeParams?.button_text_color||"#ffffff",s.MainButton.show();const t=()=>{k(s)};return s.MainButton.onClick(t),setTimeout(()=>{p(!0)},1e3),()=>{s.MainButton.offClick(t),s.MainButton.hide()}}else p(!0)},[]);const m=s=>{const{name:t,value:x}=s.target;N(o=>({...o,[t]:x})),r[t]&&u(o=>({...o,[t]:void 0}))},P=s=>{const t={};return s.client_name.trim()||(t.client_name="Le nom du client est requis."),s.client_email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.client_email)||(t.client_email="L'email du client n'est pas valide."):t.client_email="L'email du client est requis.",s.client_phone?.trim()||(t.client_phone="Le t√©l√©phone du client est requis."),t},k=s=>{const t=j.current,x=P(t);if(Object.keys(x).length>0){u(x),s?s.showAlert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire"):alert("‚ö†Ô∏è Veuillez corriger les erreurs dans le formulaire");return}d(!0),s?.MainButton.showProgress();try{const o=JSON.stringify(t);if(s){const w=`/api/telegram/client/create/${s.initDataUnsafe?.user?.id||y}`;fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:o}).then(l=>l.json()).then(l=>{if(console.log("Response data:",l),l.success)s.showAlert("‚úÖ Entreprise cr√©√©e avec succ√®s!"),setTimeout(()=>{s.close()},1e3);else{let h=`‚ùå Erreur:

`;l.errors&&typeof l.errors=="object"?Object.keys(l.errors).forEach(f=>{const b=l.errors[f];Array.isArray(b)?u(_=>({..._,[f]:b.join(", ")})):u(_=>({..._,[f]:b}))}):l.message?h+=l.message:h+="Erreur inconnue",s.showAlert(h),d(!1),s.MainButton.hideProgress()}}).catch(l=>{s.showAlert("‚ùå Une erreur est survenue: "+l),s.MainButton.hideProgress(),d(!1),s.close()})}else alert(`‚úÖ Entreprise cr√©√©e! (Mode test)

Donn√©es: `+o),d(!1)}catch(o){s?(s.showAlert("‚ùå Une erreur est survenue: "+o),s.MainButton.hideProgress()):alert("‚ùå Une erreur est survenue: "+o),d(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Cr√©er mon entreprise"}),e.jsx("div",{className:"min-h-screen p-4",style:{backgroundColor:n?.themeParams?.bg_color||"#ffffff",color:n?.themeParams?.text_color||"#000000"},children:e.jsxs("div",{className:"mx-auto max-w-2xl",children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold",children:"üè¢ Cr√©er mon entreprise"}),e.jsx("p",{className:"opacity-70",children:"Remplissez les informations de votre entreprise"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"client_name",className:"mb-2 block text-sm font-semibold",children:["Nom du client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"client_name",name:"client_name",value:a.client_name,onChange:m,placeholder:"Ex: TechSolutions Madagascar",className:`w-full rounded-xl border-2 px-4 py-3 transition-all ${r.client_name?"border-red-500 bg-red-50":"border-gray-200 focus:border-blue-500"}`,style:{backgroundColor:n?.themeParams?.secondary_bg_color||"#f5f5f5",color:n?.themeParams?.text_color||"#000000"},disabled:c}),r.client_name&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_name]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"client_email",className:"mb-2 block text-sm font-semibold",children:["Email du client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",id:"client_email",name:"client_email",value:a.client_email,onChange:m,placeholder:"Ex: 4Hs9O@example.com",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:n?.themeParams?.secondary_bg_color||"#f5f5f5",color:n?.themeParams?.text_color||"#000000"},disabled:c}),r.client_email&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_email]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"client_phone",className:"mb-2 block text-sm font-semibold",children:["T√©l√©phone du client ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",id:"client_phone",name:"client_phone",value:a.client_phone,onChange:m,placeholder:"Ex: +261 34 12 345 67",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:n?.themeParams?.secondary_bg_color||"#f5f5f5",color:n?.themeParams?.text_color||"#000000"},disabled:c}),r.client_phone&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_phone]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"client_cin",className:"mb-2 block text-sm font-semibold",children:"CIN du client"}),e.jsx("input",{type:"text",id:"client_cin",name:"client_cin",value:a.client_cin,onChange:m,placeholder:"Ex: 1 23 456 789",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:n?.themeParams?.secondary_bg_color||"#f5f5f5",color:n?.themeParams?.text_color||"#000000"},disabled:c}),r.client_cin&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_cin]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"client_address",className:"mb-2 block text-sm font-semibold",children:"Adresse du client"}),e.jsx("input",{type:"text",id:"client_address",name:"client_address",value:a.client_address,onChange:m,placeholder:"Ex: 123 Rue de l'Innovation, Antananarivo",className:"w-full rounded-xl border-2 border-gray-200 px-4 py-3 transition-all focus:border-blue-500",style:{backgroundColor:n?.themeParams?.secondary_bg_color||"#f5f5f5",color:n?.themeParams?.text_color||"#000000"},disabled:c}),r.client_address&&e.jsxs("p",{className:"mt-1 flex items-center gap-1 text-sm text-red-500",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," ",r.client_address]})]})]}),e.jsx("div",{className:"mt-8 rounded-xl border-2 border-blue-200 bg-blue-50 p-4",children:e.jsxs("p",{className:"flex items-start gap-2 text-sm text-blue-800",children:[e.jsx("span",{className:"text-lg",children:"‚ÑπÔ∏è"}),e.jsx("span",{children:C?"Cliquez sur le bouton ci-dessus pour cr√©er votre entreprise":"Cliquez sur le bouton en bas de l'√©cran pour cr√©er votre entreprise"})]})})]})})]})}export{F as default};
